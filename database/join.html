<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="keywords" content="php, database, abstraction, query builder, schema builder">
<meta name="description" content="Learn how to perform joins">
<title>Joins | Opis Database</title>
        
        <link href="/assets/img/favicon.png" rel="shortcut icon">
        
        
<link rel="stylesheet" href="/assets/css/flatly-theme.min.css">

<link href="/assets/css/font-awesome.css" rel="stylesheet">

<link href="/assets/css/syntax.css" rel="stylesheet">



<link href="/assets/css/project.css" rel="stylesheet">


        <!--[if lt IE 9]>
<script src="/assets/js/html5shiv.js"></script>
<script src="/assets/js/respond.min.js"></script>
<![endif]-->
<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
<script src="/assets/js/jquery-1.11.0.min.js"></script>
<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="/assets/js/bootstrap.min.js"></script>


<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  
    ga('create', 'UA-50415801-1', 'opis.io');
    ga('send', 'pageview');
</script>

    </head>
    <body>
        <header id="header" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
        <div class="navbar-header">
            <img src="/assets/img/opis-gs-100.png" class="img-responsive opis-inline-logo">
            <a href="" class="navbar-brand">
                <strong>
                    Database
                </strong>
            </a>
            <button data-target="#navbar-main" data-toggle="collapse" type="button" class="navbar-toggle">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
        </div>
        <nav id="navbar-main" class="collapse navbar-collapse navbar-right">
            <ul class="nav navbar-nav">
                <li>
                    <a href="/" title="Main page">
                        <span class="fa fa-home"></span> Home
                    </a>
                </li>
                <li class="dropdown">
                    <a class="dropdown-toggle" data-toggle="dropdown" href="#">
                        <span class="fa fa-cogs"></span> Components <span class="caret"></span>
                    </a>
                    <ul class="dropdown-menu">
                        <li><a href="/cache" title="Caching library">Cache</a></li>
                        <li><a href="/closure" title="Serializable closures">Closure</a></li>
                        <li><a href="/config" title="Configuration manager">Config</a></li>
                        <li><a href="/container" title="Dependency injection container">Container</a></li>
                        <li><a href="/database" title="Database abstraction layer">Database</a></li>
                        <li><a href="/events" title="Events library">Events</a></li>
                        <li><a href="https://github.com/opis/http" title="HTTP library">HTTP</a></li>
                        <li><a href="/http-routing" title="HTTP routing library">HTTP Routing</a></li>
                        <li><a href="/routing" title="Routing framework">Routing</a></li>
                        <li><a href="/session" title="Session manager">Session</a></li>
                        <li><a href="/utils" title="Utilitary classes">Utils</a></li>
                        <li><a href="/view" title="Rendering engine">View</a></li>
                    </ul>
                </li>
                <li>
                    <a href="https://github.com/opis/database" title="Github page">
                        <span class="fa fa-github fa-lg"></span> GitHub
                    </a>
                </li>
            </ul>
        </nav>
    </div>
</header>

<section>
    <div class="container">
        <div class="row">
            <div class="col-md-4">
                <div class="list-group">
                
                    
                        
<a href="/database" class="list-group-item">

    <h4 class="list-group-item-heading">About</h4>
    <p class="list-group-item-text text-muted">
        Getting started with Opis Database
    </p>
</a>
                    
                
                    
                        
<a href="/database/connection.html" class="list-group-item">

    <h4 class="list-group-item-heading">Connections</h4>
    <p class="list-group-item-text text-muted">
        Learn how to connect to a database
    </p>
</a>
                    
                
                    
                        
<a href="/database/select.html" class="list-group-item">

    <h4 class="list-group-item-heading">Fetching records</h4>
    <p class="list-group-item-text text-muted">
        Fetching records from a database
    </p>
</a>
                    
                
                    
                        
<a href="/database/result.html" class="list-group-item">

    <h4 class="list-group-item-heading">Results handling</h4>
    <p class="list-group-item-text text-muted">
        Learn how to handle the result set of a query
    </p>
</a>
                    
                
                    
                        
<a href="/database/aggregate.html" class="list-group-item">

    <h4 class="list-group-item-heading">Aggregate functions</h4>
    <p class="list-group-item-text text-muted">
        Learn about aggregate functions
    </p>
</a>
                    
                
                    
                        
<a href="/database/defining-columns.html" class="list-group-item">

    <h4 class="list-group-item-heading">Defining fetched columns</h4>
    <p class="list-group-item-text text-muted">
        Learn about how to define selected columns
    </p>
</a>
                    
                
                    
                        
<a href="/database/filter.html" class="list-group-item">

    <h4 class="list-group-item-heading">Filters</h4>
    <p class="list-group-item-text text-muted">
        Learn how to filter records
    </p>
</a>
                    
                
                    
                        
<a href="/database/order.html" class="list-group-item">

    <h4 class="list-group-item-heading">Ordering criteria</h4>
    <p class="list-group-item-text text-muted">
        Learn how to order results
    </p>
</a>
                    
                
                    
                        
<a href="/database/limit.html" class="list-group-item">

    <h4 class="list-group-item-heading">Limits and offsets</h4>
    <p class="list-group-item-text text-muted">
        Learn about limits and offsets
    </p>
</a>
                    
                
                    
                        
<a href="/database/expression.html" class="list-group-item">

    <h4 class="list-group-item-heading">Expressions</h4>
    <p class="list-group-item-text text-muted">
        Learn about expressions
    </p>
</a>
                    
                
                    
                        
<a href="/database/group.html" class="list-group-item">

    <h4 class="list-group-item-heading">Group</h4>
    <p class="list-group-item-text text-muted">
        Learn how to group results
    </p>
</a>
                    
                
                    
                        
<a href="/database/join.html" class="list-group-item active">

    <h4 class="list-group-item-heading">Joins</h4>
    <p class="list-group-item-text text-muted">
        Learn how to perform joins
    </p>
</a>
                    
                
                    
                        
<a href="/database/insert.html" class="list-group-item">

    <h4 class="list-group-item-heading">Create records</h4>
    <p class="list-group-item-text text-muted">
        Insert new records into a table
    </p>
</a>
                    
                
                    
                        
<a href="/database/update.html" class="list-group-item">

    <h4 class="list-group-item-heading">Update records</h4>
    <p class="list-group-item-text text-muted">
        Learn how to update existing records
    </p>
</a>
                    
                
                    
                        
<a href="/database/delete.html" class="list-group-item">

    <h4 class="list-group-item-heading">Delete records</h4>
    <p class="list-group-item-text text-muted">
        Learn how to delete existing records
    </p>
</a>
                    
                
                    
                        
<a href="/database/transaction.html" class="list-group-item">

    <h4 class="list-group-item-heading">Transactions</h4>
    <p class="list-group-item-text text-muted">
        Learn how to use transactions
    </p>
</a>
                    
                
                    
                        
<a href="/database/schema.html" class="list-group-item">

    <h4 class="list-group-item-heading">Schema</h4>
    <p class="list-group-item-text text-muted">
        Create new tables and obtains information about existing ones
    </p>
</a>
                    
                
                </div>
            </div>
            <div class="col-md-8">
                <h1>
    <strong>Joins</strong>
</h1>

<p>
    Joins are used to combine rows from two or more tables, based on a common field between them.
    <strong>Opis Database</strong> allows you to perform four type of joins:
    <strong>INNER</strong> join by using the <code>join</code> method,
    <strong>LEFT</strong> join by using the <code>leftJoin</code> method,
    <strong>RIGHT</strong> join by using the <code>rightJoin</code> method
    and <strong>FULL</strong> join by using the <code>fullJoin</code> method.
</p>

<p>
    Performing a join is done in a similar manner for all four types of joins.
    All join methods accepts two arguments: the first argument represents the joined table
    and the second argument must be an anonymous callback function, which will receive as an
    argument an object that will be further used to set the join's conditions to be met.
</p>

<p>
    Adding a join condition is done by using the <code>on</code> method. This methods accepts two arguments,
    representing the two columns on which the join will be performed,
    and optionally a third argument representing the comparison operator which can be one of the following:
    <code>=</code>, <code>!=</code>, <code>&gt;</code>, <code>&lt;</code>, <code>&gt;=</code> and <code>&lt;=</code>.
    If no comparison operator is specified, the <code>=</code> operator will be used by default.
</p>

<div class="highlight"><pre><code class="php"><span class="nv">$result</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">from</span><span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">)</span>
             <span class="o">-&gt;</span><span class="na">join</span><span class="p">(</span><span class="s1">&#39;profiles&#39;</span><span class="p">,</span> <span class="k">function</span><span class="p">(</span><span class="nv">$join</span><span class="p">){</span>
                <span class="nv">$join</span><span class="o">-&gt;</span><span class="na">on</span><span class="p">(</span><span class="s1">&#39;users.id&#39;</span><span class="p">,</span> <span class="s1">&#39;profiles.id&#39;</span><span class="p">);</span>
             <span class="p">})</span>
             <span class="o">-&gt;</span><span class="na">select</span><span class="p">()</span>
             <span class="o">-&gt;</span><span class="na">all</span><span class="p">();</span>
</code></pre></div>
<div class="highlight"><pre><code class="sql"><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="o">`</span><span class="n">users</span><span class="o">`</span> <span class="k">INNER</span> <span class="k">JOIN</span> <span class="o">`</span><span class="n">profiles</span><span class="o">`</span> <span class="k">ON</span> <span class="o">`</span><span class="n">users</span><span class="o">`</span><span class="p">.</span><span class="o">`</span><span class="n">id</span><span class="o">`</span> <span class="o">=</span> <span class="o">`</span><span class="n">profiles</span><span class="o">`</span><span class="p">.</span><span class="o">`</span><span class="n">id</span><span class="o">`</span>
</code></pre></div>

<p>
    Adding multiple join conditions is done by using the <code>andOn</code> and <code>orOn</code> method.
    Depending on which method you use, the join condition will be combined with the previous declared join
    condition using the <code>AND</code> or the <code>OR</code> operator.
</p>

<p>
    To add an additional condition to your join expression,
    that combines with the previous declared condition by using an <code>AND</code> operator, use the <code>andOn</code> method. 
</p>

<div class="highlight"><pre><code class="php"><span class="nv">$result</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">from</span><span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">)</span>
             <span class="o">-&gt;</span><span class="na">join</span><span class="p">(</span><span class="s1">&#39;profiles&#39;</span><span class="p">,</span> <span class="k">function</span><span class="p">(</span><span class="nv">$join</span><span class="p">){</span>
                <span class="nv">$join</span><span class="o">-&gt;</span><span class="na">on</span><span class="p">(</span><span class="s1">&#39;users.id&#39;</span><span class="p">,</span> <span class="s1">&#39;profiles.id&#39;</span><span class="p">)</span>
                     <span class="o">-&gt;</span><span class="na">andOn</span><span class="p">(</span><span class="s1">&#39;users.email&#39;</span><span class="p">,</span> <span class="s1">&#39;profile.primary_email&#39;</span><span class="p">);</span>
             <span class="p">})</span>
             <span class="o">-&gt;</span><span class="na">select</span><span class="p">()</span>
             <span class="o">-&gt;</span><span class="na">all</span><span class="p">();</span>
</code></pre></div>
<div class="highlight"><pre><code class="sql"><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="o">`</span><span class="n">users</span><span class="o">`</span>
    <span class="k">INNER</span> <span class="k">JOIN</span> <span class="o">`</span><span class="n">profiles</span><span class="o">`</span>
        <span class="k">ON</span> <span class="o">`</span><span class="n">users</span><span class="o">`</span><span class="p">.</span><span class="o">`</span><span class="n">id</span><span class="o">`</span> <span class="o">=</span> <span class="o">`</span><span class="n">profiles</span><span class="o">`</span><span class="p">.</span><span class="o">`</span><span class="n">id</span><span class="o">`</span>
        <span class="k">AND</span> <span class="o">`</span><span class="n">users</span><span class="o">`</span><span class="p">.</span><span class="o">`</span><span class="n">email</span><span class="o">`</span> <span class="o">=</span> <span class="o">`</span><span class="n">profile</span><span class="o">`</span><span class="p">.</span><span class="o">`</span><span class="n">primary_email</span><span class="o">`</span>
</code></pre></div>

<p>
    To add an additional condition to your join expression,
    that combines with the previous declared condition by using an <code>OR</code> operator, use the <code>orOn</code> method. 
</p>

<div class="highlight"><pre><code class="php"><span class="nv">$result</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">from</span><span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">)</span>
             <span class="o">-&gt;</span><span class="na">join</span><span class="p">(</span><span class="s1">&#39;profiles&#39;</span><span class="p">,</span> <span class="k">function</span><span class="p">(</span><span class="nv">$join</span><span class="p">){</span>
                <span class="nv">$join</span><span class="o">-&gt;</span><span class="na">on</span><span class="p">(</span><span class="s1">&#39;users.id&#39;</span><span class="p">,</span> <span class="s1">&#39;profiles.id&#39;</span><span class="p">)</span>
                     <span class="o">-&gt;</span><span class="na">orOn</span><span class="p">(</span><span class="s1">&#39;users.email&#39;</span><span class="p">,</span> <span class="s1">&#39;profile.primary_email&#39;</span><span class="p">);</span>
             <span class="p">})</span>
             <span class="o">-&gt;</span><span class="na">select</span><span class="p">()</span>
             <span class="o">-&gt;</span><span class="na">all</span><span class="p">();</span>
</code></pre></div>
<div class="highlight"><pre><code class="sql"><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="o">`</span><span class="n">users</span><span class="o">`</span>
    <span class="k">INNER</span> <span class="k">JOIN</span> <span class="o">`</span><span class="n">profiles</span><span class="o">`</span>
        <span class="k">ON</span> <span class="o">`</span><span class="n">users</span><span class="o">`</span><span class="p">.</span><span class="o">`</span><span class="n">id</span><span class="o">`</span> <span class="o">=</span> <span class="o">`</span><span class="n">profiles</span><span class="o">`</span><span class="p">.</span><span class="o">`</span><span class="n">id</span><span class="o">`</span>
        <span class="k">OR</span> <span class="o">`</span><span class="n">users</span><span class="o">`</span><span class="p">.</span><span class="o">`</span><span class="n">email</span><span class="o">`</span> <span class="o">=</span> <span class="o">`</span><span class="n">profile</span><span class="o">`</span><span class="p">.</span><span class="o">`</span><span class="n">primary_email</span><span class="o">`</span>
</code></pre></div>

<p>
    You can also group your join conditions, by passing as an argument to the <code>on</code>,
    <code>andOn</code> and <code>orOn</code> methods, an anonymous callback function.
</p>

<div class="highlight"><pre><code class="php"><span class="nv">$result</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">from</span><span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">)</span>
             <span class="o">-&gt;</span><span class="na">join</span><span class="p">(</span><span class="s1">&#39;profiles&#39;</span><span class="p">,</span> <span class="k">function</span><span class="p">(</span><span class="nv">$join</span><span class="p">){</span>
                <span class="nv">$join</span><span class="o">-&gt;</span><span class="na">on</span><span class="p">(</span><span class="s1">&#39;users.id&#39;</span><span class="p">,</span> <span class="s1">&#39;profiles.id&#39;</span><span class="p">)</span>
                     <span class="o">-&gt;</span><span class="na">andOn</span><span class="p">(</span><span class="k">function</span><span class="p">(</span><span class="nv">$join</span><span class="p">){</span>
                        <span class="nv">$join</span><span class="o">-&gt;</span><span class="na">on</span><span class="p">(</span><span class="s1">&#39;users.email&#39;</span><span class="p">,</span> <span class="s1">&#39;profiles.primary_email&#39;</span><span class="p">)</span>
                             <span class="o">-&gt;</span><span class="na">orOn</span><span class="p">(</span><span class="s1">&#39;users.email&#39;</span><span class="p">,</span> <span class="s1">&#39;profiles.secondary_email&#39;</span><span class="p">);</span>
                     <span class="p">});</span>
             <span class="p">})</span>
             <span class="o">-&gt;</span><span class="na">select</span><span class="p">()</span>
             <span class="o">-&gt;</span><span class="na">all</span><span class="p">();</span>
</code></pre></div>
<div class="highlight"><pre><code class="sql"><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="o">`</span><span class="n">users</span><span class="o">`</span>
    <span class="k">INNER</span> <span class="k">JOIN</span> <span class="o">`</span><span class="n">profiles</span><span class="o">`</span>
        <span class="k">ON</span> <span class="o">`</span><span class="n">users</span><span class="o">`</span><span class="p">.</span><span class="o">`</span><span class="n">id</span><span class="o">`</span> <span class="o">=</span> <span class="o">`</span><span class="n">profiles</span><span class="o">`</span><span class="p">.</span><span class="o">`</span><span class="n">id</span><span class="o">`</span>
        <span class="k">AND</span> <span class="p">(</span><span class="o">`</span><span class="n">users</span><span class="o">`</span><span class="p">.</span><span class="o">`</span><span class="n">email</span><span class="o">`</span> <span class="o">=</span> <span class="o">`</span><span class="n">profiles</span><span class="o">`</span><span class="p">.</span><span class="o">`</span><span class="n">primary_email</span><span class="o">`</span>
                <span class="k">OR</span>
             <span class="o">`</span><span class="n">users</span><span class="o">`</span><span class="p">.</span><span class="o">`</span><span class="n">email</span><span class="o">`</span> <span class="o">=</span> <span class="o">`</span><span class="n">profiles</span><span class="o">`</span><span class="p">.</span><span class="o">`</span><span class="n">secondary_email</span><span class="o">`</span><span class="p">)</span>
</code></pre></div>

<p>
    Aliasing the table name used within a join, is done by passing a <code>key => value</code>
    mapped array to the used join method, where the <code>key</code> represents the table's name and
    the <code>value</code> represents the alias name.
</p>

<div class="highlight"><pre><code class="php"><span class="nv">$result</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">from</span><span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">)</span>
             <span class="o">-&gt;</span><span class="na">join</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="s1">&#39;profiles&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;p&#39;</span><span class="p">),</span> <span class="k">function</span><span class="p">(</span><span class="nv">$join</span><span class="p">){</span>
                <span class="nv">$join</span><span class="o">-&gt;</span><span class="na">on</span><span class="p">(</span><span class="s1">&#39;users.id&#39;</span><span class="p">,</span> <span class="s1">&#39;p.id&#39;</span><span class="p">);</span>
             <span class="p">})</span>
             <span class="o">-&gt;</span><span class="na">select</span><span class="p">()</span>
             <span class="o">-&gt;</span><span class="na">all</span><span class="p">();</span>
</code></pre></div>
<div class="highlight"><pre><code class="sql"><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="o">`</span><span class="n">users</span><span class="o">`</span> <span class="k">INNER</span> <span class="k">JOIN</span> <span class="o">`</span><span class="n">profiles</span><span class="o">`</span> <span class="k">AS</span> <span class="o">`</span><span class="n">p</span><span class="o">`</span> <span class="k">ON</span> <span class="o">`</span><span class="n">users</span><span class="o">`</span><span class="p">.</span><span class="o">`</span><span class="n">id</span><span class="o">`</span> <span class="o">=</span> <span class="o">`</span><span class="n">p</span><span class="o">`</span><span class="p">.</span><span class="o">`</span><span class="n">id</span><span class="o">`</span>
</code></pre></div>

                





    
        
            
                
            
        
    

    
        
            
                
            
        
    

    
        
            
                
            
        
    

    
        
            
                
            
        
    

    
        
            
                
            
        
    

    
        
            
                
            
        
    

    
        
            
                
            
        
    

    
        
            
                
            
        
    

    
        
            
                
            
        
    

    
        
            
                
            
        
    

    
        
            
                
            
        
    

    
        
            
        
    

    
        
            
                
                
            
        
    

    

    

    

    


<ul class="pager">
  
  <li class="previous"><a href="/database/group.html" title="Group">&larr; Back</a></li>
  
  
  <li class="next"><a href="/database/insert.html" title="Create records">Next &rarr;</a></li>
  
</ul>
                
            </div>
        </div>
    </div>
</section>

<footer class="text-center text-muted">
    Copyright &copy; 2014-2015 Marius Sarca. All rights reserved.
</footer>

    </body>
</html>
